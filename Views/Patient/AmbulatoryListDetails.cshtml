@model eDoc.Models.View.Patient.AmbulatoryListDetailsViewModel

<h1>Амбулаторен лист</h1>
<div class="container-fluid">
        <div class="card">
            <!--Top container for patient & doctor details -->
            <div class="card-header">
                <div class="form-row">
                    <!-- Patient details-->
                    <div class="col">
                        <h5 class="card-title">
                            <strong>Пациент: @Model.PatientFullName</strong>
                        </h5>
                        <h6>
                            <strong>ЕГН: @Model.PatientPIN</strong>
                        </h6>
                        <small class="text-muted">Дата на раждане: @Model.PatientDateOfBirth</small><br />
                        <small class="text-muted">Адрес: @Model.PatientAddress</small><br />
                        <small class="text-muted">Код държава: @Model.PatientCountryCode</small><br />
                    </div>
                    <!-- Doctor details-->
                    <div class="col">
                        <h5 class="card-title">
                            <strong>Лекар:</strong><br />
                            @Model.DoctorFullName<br />
                            <small class="text-muted">Код специалност: @Model.DoctorSpecialtyCode</small>
                        </h5>
                        <h6>
                            <strong>УИН:</strong> @Model.DoctorUIN<br />
                            <strong>НЗОК №: </strong> @Model.NZOKNumber
                        </h6>
                        <div class="form-row align-content-center">
                            @Model.SubstituteType.ToString()
                        </div>
                    </div>
                </div>
            </div>
            <!-- Ambulatory list №, create date & time -->
            <div class="card-body">
                <div class="form-row text-center">
                    <div class="col-4">
                        <h6>НОВ АМБУЛАТОРЕН ЛИСТ № @Model.Id</h6>
                    </div>
                    <div class="col-4">
                        <h6>дата: @Model.CreatedOn.ToShortDateString()</h6>
                    </div>
                    <div class="col-4">
                        <h6>час: @Model.CreatedOn.ToShortTimeString()</h6>
                    </div>
                </div>
            </div>
            <!-- Main content of the Ambulatory list-->
            <div class="card-footer">
                <div class="form-row text-center">
                    <!-- Left hand-side of the form-->
                    <div class="col">
                        <!-- Reason for the visit selection -->
                        <div class="input-group mb-3">
                            @Model.VisitReason.ToString()
                        </div>
                        <!-- Type of check-up selection -->
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="checkupType">Вид преглед: @Model.TypeOfCheckup.ToString()</label>
                            </div>
                        </div>
                    </div>
                    <!-- Right hand-side of the form-->
                    <div class="col">
                        <div class="input-group row m-0">
                           @Model.MedicalHistory
                        </div>
                        <div class="input-group">
                          @Model.ObjectiveCondition
                        </div>
                        <div class="input-group">
                           @Model.Examinations
                        </div>
                        <div class="input-group">
                            @Model.Therapy
                        </div>
                        <div class="input-group">
                           @Model.Diagnosis
                        </div>
                        <div class="input-group">
                           @Model.AccompanyingConditions
                        </div>
                    </div>
                </div>
            </div>
        </div>

</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

    <script>
        $(document).on('change', '#PatientId', function (e) {
            var id = this.options[e.target.selectedIndex].value;
            $.ajax({
                method: 'GET',
                url: '/api/PatientDetails',
                contentType: 'application/json; charset=utf-8',
                data: { "id": id },
                dataType: 'json'
            })
                .done(function success(data) {
                    let birthDate = new Date(data.birthDate);

                    //Remove the values in the fields
                    $("#EGN").contents().remove();
                    $("#BirthDate").contents().remove();
                    $("#Address").contents().remove();
                    $("#CountryCode").contents().remove();
                    //Populate the values from the server
                    $("#EGN").prepend(data.pin);
                    $("#Address").prepend(data.fullAddress);
                    $("#BirthDate").prepend(
                        birthDate.getDate() + '.' +
                        (birthDate.getMonth() + 1) + '.' +
                        birthDate.getFullYear() + ' г.'
                    );
                    $("#CountryCode").prepend(data.countryCode);
                })
                .fail(function fail(data, status) {
                    alert('AJAX Request failed.');
                });
        });
    </script>
    <!-- Reset button clean up-->
    <script>

        $(document).on('click', '#reset', function (e) {
            //Remove the values in the fields
            $("#EGN").contents().remove();
            $("#BirthDate").contents().remove();
            $("#Address").contents().remove();
            $("#CountryCode").contents().remove();
        });
    </script>
}